<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Carte Appartements</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
  <link rel="stylesheet" href="assets/styles.css"/>
</head>
<body>
  <header>
    <h1>Carte des appartements</h1>
    <div class="controls">
      <label>Max loyer (‚Ç¨): <input id="maxRent" type="number" min="0" placeholder="ex: 850"></label>
      <label>Type: 
        <select id="typeFilter">
          <option value="">Tous</option>
          <option>T1</option>
          <option>T1bis</option>
          <option>T2</option>
          <option>T3</option>
          <option>T4</option>
        </select>
      </label>
      <label>Parking: 
        <select id="parkingFilter">
          <option value="">Indiff√©rent</option>
          <option value="oui">Oui</option>
          <option value="non">Non</option>
        </select>
      </label>
      <button id="resetBtn" type="button">R√©initialiser</button>
      <div class="spacer"></div>
      <!-- Boutons CSV locaux (facultatifs) -->
      <button id="linkCsvBtn" type="button">Lier CSV (√©criture)</button>
      <button id="saveCsvBtn" type="button" disabled>Enregistrer CSV</button>
      <span id="fileStatus" class="muted"></span>
      <button id="exportCsvBtn" type="button">Exporter CSV</button>
      <button id="exportJsonBtn" type="button">Exporter JSON</button>
    </div>
  </header>

  <details class="panel">
    <summary>‚ûï Ajouter un appartement</summary>
    <form id="addForm" class="form-grid">
      <div>
        <label for="f_loyer">Loyer (‚Ç¨)</label>
        <input id="f_loyer" name="loyer" type="number" min="0" step="1" placeholder="ex: 754">
      </div>
      <div class="full">
        <label for="f_adresse">Adresse / Quartier</label>
        <input id="f_adresse" name="adresse" type="text" placeholder="ex: 11 Rue des Bleuets, Montpellier">
      </div>
      <div>
        <label for="f_cuisine">Cuisine √©quip√©e</label>
        <select id="f_cuisine" name="cuisine_equipee">
          <option value="">‚Äî</option>
          <option value="oui">Oui</option>
          <option value="non">Non</option>
        </select>
      </div>
      <div>
        <label for="f_type">Type</label>
        <select id="f_type" name="type">
          <option value="">‚Äî</option>
          <option value="T1">T1</option>
          <option value="T1bis">T1bis</option>
          <option value="T2">T2</option>
          <option value="T3">T3</option>
          <option value="T4">T4</option>
          <option value="T5">T5</option>
        </select>
      </div>
      <div>
        <label for="f_parking">Parking</label>
        <select id="f_parking" name="parking">
          <option value="">‚Äî</option>
          <option value="oui">Oui</option>
          <option value="non">Non</option>
        </select>
      </div>
      <div>
        <label for="f_chambres">Nombre de chambres</label>
        <input id="f_chambres" name="chambres" type="number" min="0" step="1" placeholder="ex: 1">
      </div>
      <div>
        <label for="f_surface">Surface (m¬≤)</label>
        <input id="f_surface" name="surface_m2" type="number" min="0" step="0.1" placeholder="ex: 46.7">
      </div>
      <div class="full">
        <label for="f_url">Lien de l‚Äôannonce</label>
        <input id="f_url" name="url" type="url" placeholder="https://‚Ä¶">
      </div>
      <div>
        <label for="f_label">Label (quartier, note‚Ä¶)</label>
        <input id="f_label" name="label" type="text" placeholder="ex: Ovalie">
      </div>
      <div>
        <label for="f_lat">Latitude (optionnel)</label>
        <input id="f_lat" name="latitude" type="number" step="0.000001" placeholder="ex: 43.610">
      </div>
      <div>
        <label for="f_lng">Longitude (optionnel)</label>
        <input id="f_lng" name="longitude" type="number" step="0.000001" placeholder="ex: 3.876">
      </div>

      <div class="full actions">
        <button type="submit">Ajouter</button>
        <button id="sendToGitHubBtn" type="button" title="Ouvre un Issue pr√©rempli">Envoyer √† GitHub (Issue)</button>
        <span id="addStatus" aria-live="polite"></span>
      </div>
      <p class="hint">
        Sans coordonn√©es, le point n‚Äôappara√Æt pas sur la carte. Donne une adresse (ou un label ‚Äúquartier‚Äù) pour un g√©ocodage automatique.
      </p>
    </form>
  </details>

  <details class="panel" open>
    <summary>üìÑ Entr√©es non localis√©es (<span id="unlocCount">0</span>)</summary>
    <div id="unlocList" class="list"></div>
  </details>

  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
  <script src="assets/config.js"></script>
  <script src="assets/app.js"></script>
</body>
</html>
